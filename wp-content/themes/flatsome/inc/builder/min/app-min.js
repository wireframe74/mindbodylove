function uxgetCookie(t){var e,a;return document.cookie.length>0&&(e=document.cookie.indexOf(t+"="),-1!==e)?(e=e+t.length+1,a=document.cookie.indexOf(";",e),-1===a&&(a=document.cookie.length),unescape(document.cookie.substring(e,a))):""}function ux_UploadImage(t){var e;return event.preventDefault(),e?void e.open():(e=wp.media.frames.file_frame=wp.media({title:"Select image",button:{text:"Select"},multiple:!1}),e.on("select",function(){attachment=e.state().get("selection").first().toJSON();var a=attachment.url;jQuery(t).find("input").val(a).change()}),void e.open())}var uxcreateCookie=function(t,e,a){var n;if(a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3),n="; expires="+o.toGMTString()}else n="";document.cookie=t+"="+e+n+"; path=/"};if("enabled"===uxgetCookie("uxbuilder")){var doc=document.documentElement;doc.setAttribute("data-uxbuilder","enabled")}else{var doc=document.documentElement;doc.setAttribute("data-uxbuilder","disabled")}jQuery(document).ready(function($){function t(t){return t.split("\n\n").map($.trim).filter(function(t){return""!==t}).join("\n\n")}function e(t){var e=t,a={action:"ux_get_content_shortcodes",content:e};$.post(ajaxurl,a,function(t){$(".ux-g-new").html(t),l(".ux-g-new > .ux-g"),$(".ux-g-new > .ux-g").unwrap()})}function a(t){var e="";return $(t).hasClass("tmce-active")?($(t).find(".switch-html").one().click(),e=$(t).find("textarea.wp-editor-area").val(),$(t).find(".switch-tmce").one().click().click()):e=$(t).find("textarea.wp-editor-area").val(),e}function n(t,e){$(t).hasClass("tmce-active")?($(t).find(".switch-html").one().click(),$(t).find("textarea.wp-editor-area").val(e),$(t).find(".switch-tmce").one().click().click()):$(t).find("textarea.wp-editor-area").val(e)}function o(){$(".ux-g-group").sortable({item:"> .ux-g",connectWith:'.ux-g-group:not([data-group="row"])',tolerance:"intersect",start:function(t,e){$("#drag-and-drop").addClass("dragging")},stop:function(t,e){$("#drag-and-drop").removeClass("dragging")},beforeStop:function(t,e){var a=$(e.item).data("id");$(e.placeholder).parents().data("group")===a&&($(this).sortable("cancel"),$("#drag-and-drop").removeClass("dragging")),"row"===$(e.placeholder).parent().data("group")&&"col"!==a&&($(this).sortable("cancel"),$("#drag-and-drop").removeClass("dragging"))}}),$('[data-group="row"]').sortable({connectWith:'[data-group="row"]'}),$('[data-group="col"]').sortable({connectWith:'[data-group="col"],[data-group="section"],[data-group="tab"]'}),$('[data-group="ux_price_table"]').sortable({connectWith:'[data-group="ux_price_table"]'}),$('[data-group="tabgroup"],[data-group="tabgroup_vertical"]').sortable({connectWith:'[data-group="tabgroup"],[data-group="tabgroup_vertical"]'}),$('[data-group="accordion"]').sortable({connectWith:'[data-group="accordion"]'})}function i(t){t||(t=".ux-g"),$(t+" s").each(function(){var t=$(this).find("em").text();t=t.replace(/((([^=]+)=((?:"|'))([^"']+)\4) ?)/g,'<span class="edit-shortcode" data-edit="$3"><strong>$3</strong>="<span>$5</span>"</span> '),t=t.replace(/="\s/g,'="'),$(this).find("em").html(t),$("span.edit-shortcode span").editable(function(t){return setTimeout(function(){d()},100),t},{tooltip:"Click to edit...",style:"inherit"})}),d(t)}function d(t){t||(t=".ux-g"),$(t+'[data-id="col"],'+t+' [data-id="col"]').each(function(){$(this).removeClass(function(t,e){return(e.match(/(^|\s)span\S+/g)||[]).join(" ")});var t=$(this).find('.edit-shortcode[data-edit="span"]').find("span").text();t=t.replace("/","_"),$(this).addClass("span"+t)})}function r(o){o||(o=".ux-g"),$(o+" .ux-g-add, .ux-add-elements-wrap .ux-g-add").off("click").on("click",function(t){$("#drag-and-drop .ux-add-section").remove();var a=$(this).parent().data("id"),n=" ";n=$('.ux-add-section[data-add-section="'+a+'"]').length?$('.ux-add-section[data-add-section="'+a+'"]').clone().css("display","block"):$('.ux-add-section[data-add-section="default"]').clone().css("display","block");var o=$(this);return $(n).find(".ux-add-div").off("click").on("click",function(t){$(".ux-g .ux-add-section, .ux-add-elements-wrap .ux-add-section").remove();var a='<div class="ux-g-new ux-g"><span class="spinner" style="display:block;float:none;"></span></div>';if($(this).hasClass("ux-has-more"))return $(this).find("ul").css("display","block"),t.preventDefault(),!1;if($(this).hasClass("has-lightbox")){var n=$('.ux-lightbox[data-add="'+$(this).data("shortcode")+'"]');$(n).addClass("active"),$(n).find(".ux-add-div:not(.ux-has-more)").off("click").on("click",function(t){$(o).hasClass("top")?$(".drag-drop-content").prepend(a):$(o).hasClass("bottom")?$(".drag-drop-content").append(a):$(o).parent().find("> .ux-g-group").append(a);var i=$(this).find("textarea").val();return $(n).removeClass("active"),e(i),t.preventDefault(),!1})}else{var i=$(this).find("textarea").val();$(o).hasClass("top")?$(".drag-drop-content").prepend(a):$(o).hasClass("bottom")?$(".drag-drop-content").append(a):$(o).parent().find("> .ux-g-group").append(a),e(i)}t.preventDefault()}),$(this).after(n),t.preventDefault(),!1}),$(o+' [data-action="edit"]').off("click").on("click",function(t){$(this).parent().parent().addClass("ux-current");var e=$(this).parent().parent().find("> s > em.ux-edit");$("textarea#new_shortcode").html("");var a=$(this).parent().parent().data("id"),n={action:"get_shortcode_editor",shortcode:a};$(".edit-shortcode-container").html('<span class="spinner" style="display:block;float:none;margin:30px;"></span>'),$('.ux-lightbox[data-edit="shortcode"]').addClass("active"),$.post(ajaxurl,n,function(t){$(".edit-shortcode-container").html(t),$(e).find(".edit-shortcode").each(function(){var t=$(this).data("edit"),e=$(this).find("span").text();$("#shortcode-editor").find('[data-id="'+t+'"]').val(e),$("textarea#new_shortcode").append(t+'="'+e+'" ')}),$(".ux-color-picker").wpColorPicker(),$("#block-select").change(),$('[data-group="Settings"],[data-grouping="Settings"]').addClass("active"),$(".ux-shortcode-group").find("input").keypress(function(t){(13===t.which||9===t.which)&&($(this).change().blur(),t.preventDefault())}),$("[data-grouping]").click(function(t){$("[data-grouping], [data-group]").removeClass("active"),$(this).addClass("active"),$(this).parent().parent().find('[data-group="'+$(this).data("grouping")+'"]').addClass("active"),t.preventDefault()}),$(".ux-edit-checkbox").each(function(){var t=$(this).find('input[type="text"]');$(this).find('input[type="text"]').val().length&&$(this).find('input[type="checkbox"]').attr("checked","true"),$(this).find('input[type="checkbox"]').change(function(){$(t).val($(this).is(":checked")?$(this).val():"")})}),$("#shortcode-editor input, #shortcode-editor select").change(function(){$("textarea#new_shortcode").html(""),$("#shortcode-editor [data-id]").each(function(){var t=$(this).data("id"),e=$(this).val();e&&$("textarea#new_shortcode").append(t+'="'+e+'" ')})}),$(".close-lightbox").off("click").on("click",function(t){$(this).hasClass("save")&&($(e).text($("textarea#new_shortcode").val()),i(".ux-current")),$(".ux-current").removeClass("ux-current"),$(".ux-lightbox").removeClass("active"),t.preventDefault()})}),t.preventDefault()}),$(o+' [data-action="duplicate"]').off("click").on("click",function(t){$("#drag-and-drop .ux-add-section").remove();var e=$(this).parent().parent().clone().removeClass("active").addClass("ux-g-added");$(this).parent().parent().after(e),setTimeout(function(){$(e).removeClass("ux-g-added")},300),l(".ux-g-added"),t.preventDefault()}),$(o+' [data-action="delete"]').off("click").on("click",function(t){$("#drag-and-drop .ux-add-section").remove(),$(this).parent().parent().slideUp(100,function(){$(this).remove()}),t.preventDefault()}),$(o+" .ux-g-text-inner").off("click").on("click",function(e){var o=$(this),i=t($(this).html());n("#wp-ux_edit_content-wrap",i),$('.ux-lightbox[data-edit="text"]').addClass("active"),e.preventDefault(),$(".close-lightbox").off("click").on("click",function(t){$(".ux-lightbox").removeClass("active"),$(this).hasClass("save")?($(o).html(a("#wp-ux_edit_content-wrap")),$(o).find(".button:first").before("<p></p>")):$(this).hasClass("delete")&&$(o).slideUp(100,function(){$(this).remove()}),t.preventDefault()})})}function c(){$("#new-content").html($("#drag-and-drop .drag-drop-content").html()),$("#new-content .ux-g-text-inner, #new-content .ux-g-group, #new-content .ux-g-content,#new-content .ux-edit, #new-content .ux-g s,#new-content .edit-shortcode > strong,.edit-shortcode > span, #new-content span.edit-shortcode, #new-content .ux-g").each(function(){$(this).replaceWith(this.childNodes)}),$("#new-content .ux-add-section, #new-content .ux-g-tools, #new-content .ux-g-add, #new-content .temp-div").remove();var e=$.trim($("#new-content").html());e=e.replace(/\[text\]/g,""),e=e.replace(/\[\/text\]/g,""),e=e.replace(/(\[[^\/](.*?)\])/g,"$1\n"),e=e.replace(/(\[[\/](.*?)\])/g,"\n$1\n"),e=t(e),e=e.replace(/(\[[^\/](.*?)\])/g,"$1\n"),e=e.replace(/(\[[\/](.*?)\])/g,"\n$1\n"),e=t(e),e=e.replace(/\s+(?=[^[\]]*\])/g," "),e=e.replace(/\s]/g,"]"),n("#wp-content-wrap",e)}function s(){var t=a("#wp-content-wrap");if(t){$(".drag-drop-content").html('<div class="ux-g"><span class="spinner" style="display:block;float:none;"></span></div>');var e={action:"ux_get_content_shortcodes",content:t};$.post(ajaxurl,e,function(t){$("#drag-and-drop .drag-drop-content").html(t),$(".ux-g-text-inner").find(".button:first").before("<p></p>"),$("#uxbuilder-enable-disable").removeClass("disabled"),l()})}else $(".drag-drop-content").html(""),l()}function l(t){$(".ux-g").off("mouseover").on("mouseover",function(t){t.stopPropagation(),$(this).addClass("active")}).on("mouseout",function(){$(this).removeClass("active")}),o(),i(t),r(t)}$('html[data-uxbuilder="enabled"]').length?($("a#enable-uxbuilder").addClass("active"),setTimeout(function(){s()},300)):$("a#disable-uxbuilder").addClass("active"),$('#disable-uxbuilder, .button[name="save"], .preview.button').click(function(){$('html[data-uxbuilder="enabled"]').length&&c()}),$("a#enable-uxbuilder").click(function(t){uxcreateCookie("uxbuilder","enabled"),$(this).parent().addClass("disabled"),$("#uxbuilder-enable-disable a").removeClass("active"),$("html").attr("data-uxbuilder","enabled"),$(this).addClass("active"),s(),$(window).resize(),t.preventDefault()}),$("a#disable-uxbuilder").click(function(t){uxcreateCookie("uxbuilder","disabled"),$("#uxbuilder-enable-disable a").removeClass("active"),$("html").attr("data-uxbuilder","disabled"),$(this).addClass("active"),$(window).resize(),t.preventDefault()}),$(".close-lightbox").click(function(){$(".ux-lightbox").removeClass("active")})});